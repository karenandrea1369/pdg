{"version":3,"sources":["scripts/pages/index.js"],"names":["firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","firebase","initializeApp","window","addEventListener","email","document","getElementById","pass","db","firestore","auth","loginBtn","querySelector","confirmUser","onAuthStateChanged","user","console","log","uid","actualUser","collection","where","get","then","querySnapshot","forEach","doc","id","data","iddoc","goToRole","validate","setSuccessFor","signInWithEmailAndPassword","value","userCredential","catch","error","code","setErrorFor","errorCode","errorMessage","message","idDoc","exists","student","location","href","teacher","boss","emailValue","trim","passValue","val1","val2","isEmail","input","inputBox","parentElement","small","innerText","classList","add","remove","test"],"mappings":"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","file":"pages.7852bfa2.js","sourceRoot":"..\\src","sourcesContent":["// TODO: Replace the following with your app's Firebase project configuration\r\n// For Firebase JavaScript SDK v7.20.0 and later, `measurementId` is an optional field\r\nvar firebaseConfig = {\r\n    apiKey: \"AIzaSyDjl6bYnNz0DdeWM7hWxITVpn1BQq6SSjI\",\r\n    authDomain: \"pdg-db.firebaseapp.com\",\r\n    projectId: \"pdg-db\",\r\n    storageBucket: \"pdg-db.appspot.com\",\r\n    messagingSenderId: \"848702577304\",\r\n    appId: \"1:848702577304:web:89c4212e674efb5c3bceed\",\r\n    measurementId: \"G-SBDH6RW0HW\"\r\n};\r\n\r\n// Initialize Firebase\r\nfirebase.initializeApp(firebaseConfig);\r\n\r\nwindow.addEventListener('load', ()=>{\r\n    \r\n    //-----------------------------------------------------------\r\n    const email = document.getElementById('email');\r\n    const pass = document.getElementById('pass');\r\n    var db = firebase.firestore();\r\n    var auth = firebase.auth();\r\n    const loginBtn = document.querySelector('.login__button');\r\n    //var cursos = [];\r\n\r\n    var confirmUser = true;\r\n\r\n    auth.onAuthStateChanged(user =>{\r\n        if(user && confirmUser){\r\n            console.log(\"user\", user.uid);\r\n            let actualUser = db.collection(\"people\").where(\"id\", \"==\", user.uid).get().then((querySnapshot) => {\r\n                querySnapshot.forEach((doc) => {\r\n                    console.log(doc.id, ' => ', doc.data());\r\n                    console.log('Este es su idDoc', doc.data().iddoc);\r\n                    goToRole(doc.data().iddoc);\r\n                });\r\n            });\r\n        }else{\r\n            console.log(\"No hay usuario\");\r\n        }\r\n    });\r\n\r\n    loginBtn.addEventListener('click', ()=>{\r\n        confirmUser = false;\r\n        if(validate()){\r\n            setSuccessFor(email);\r\n            setSuccessFor(pass);\r\n            auth.signInWithEmailAndPassword(email.value, pass.value)\r\n            .then((userCredential) => {\r\n                // Signed in\r\n                var user = userCredential.user;\r\n                console.log('user credential', userCredential);\r\n                console.log('User', user);\r\n                auth.onAuthStateChanged(user =>{\r\n                    console.log(\"user\", user.uid);\r\n                    let actualUser = db.collection(\"people\").where(\"id\", \"==\", user.uid).get().then((querySnapshot) => {\r\n                        querySnapshot.forEach((doc) => {\r\n                            //console.log(doc.id, ' => ', doc.data());\r\n                            //console.log('Este es su idDoc', doc.data().iddoc);\r\n                            goToRole(doc.data().iddoc);\r\n                        });\r\n                    });\r\n                });\r\n            })\r\n            .catch((error) => {\r\n                if(error.code === 'auth/wrong-password'){\r\n                    setErrorFor(pass, 'Contraseña incorrecta');\r\n                } else if(error.code === 'auth/user-not-found'){\r\n                    setErrorFor(email, 'El usuario no existe');\r\n                }\r\n                var errorCode = error.code;\r\n                var errorMessage = error.message;\r\n            });\r\n        }\r\n    });\r\n\r\n    function goToRole(idDoc){\r\n        db.collection(\"people\").doc(idDoc).get().then((doc) => {\r\n            if (doc.exists) {\r\n                if(doc.data().student){\r\n                    window.location.href = \"studentDash.html\"; \r\n                } else if(doc.data().teacher == true && doc.data().boss == false){\r\n                    window.location.href = \"teacherDash.html\";\r\n                } else if(doc.data().teacher && doc.data().boss){\r\n                    window.location.href = \"teacherBossDash.html\";\r\n                }\r\n            } else {\r\n                // doc.data() will be undefined in this case\r\n                console.log(\"No such document!\");\r\n            } \r\n        \r\n        });\r\n    }\r\n\r\n    function validate (){\r\n\r\n        const emailValue = email.value.trim();\r\n        const passValue = pass.value.trim();\r\n\r\n        var val1 = false, val2 = false;\r\n\r\n        if(emailValue === ''){\r\n            setErrorFor(email, 'El campo es obligatorio');\r\n        }\r\n        else if(!isEmail(emailValue)){\r\n            setErrorFor(email, 'El correo no es válido');\r\n        } else {\r\n            setSuccessFor(email);\r\n            val1 = true;\r\n        }\r\n\r\n        if(passValue === ''){\r\n            setErrorFor(pass, 'El campo es obligatorio');\r\n        }else {\r\n            setSuccessFor(pass);\r\n            val2 = true;\r\n        }\r\n\r\n        if(val1 && val2){\r\n            console.log('todo okkkkkkkk');\r\n            return true;\r\n        } else {\r\n            console.log('algo mal');\r\n            console.log('val1'. val1);\r\n            console.log('val2', val2);\r\n            return false;\r\n        }\r\n\r\n    };\r\n\r\n    function setErrorFor(input, message){\r\n        const inputBox = input.parentElement;\r\n        const small = inputBox.querySelector('small');\r\n        small.innerText = message;\r\n        inputBox.classList.add('login__inputError');\r\n    };\r\n\r\n    function setSuccessFor(input){\r\n        const inputBox = input.parentElement;\r\n        inputBox.classList.remove('login__inputError');\r\n    };\r\n\r\n    function isEmail(email){\r\n        return /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/.test(email);\r\n    };\r\n\r\n    // db.collection(\"Cursos\").doc(\"Curso1\").collection(\"2021-1\").get().then((querySnapshot) => {\r\n    //     querySnapshot.forEach((doc) => {\r\n    //         console.log(`${doc.id} => ${doc.data()}`);\r\n    //         cursos.push(doc.data());\r\n    //     });\r\n    //     // cursos.forEach((curso)=>{\r\n    //     //     console.log(curso.Semestre);\r\n    //     // });\r\n\r\n    // });\r\n\r\n    // db.collection(\"Cursos\").doc(\"Curso1\").collection(\"2021-1\").doc(\"Informacion\").get().then((doc) => {\r\n    //     if (doc.exists) {\r\n    //         console.log(\"Document data:\", doc.data());\r\n    //         titulo.innerHTML = `Hola ${doc.data().Profesor}`;\r\n    //     } else {\r\n    //         // doc.data() will be undefined in this case\r\n    //         console.log(\"No such document!\");\r\n    //     } \r\n    // });\r\n});"]}