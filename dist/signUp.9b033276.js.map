{"version":3,"sources":["scripts/pages/signUp.js"],"names":["firebaseConfig","apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId","measurementId","firebase","initializeApp","window","addEventListener","form","document","getElementById","email","idDoc","pass","confirmPass","signUpBtn","querySelector","auth","db","firestore","onAuthStateChanged","user","console","log","uid","actualUser","collection","where","get","then","querySnapshot","forEach","doc","id","data","iddoc","goToRole","validate","createUserWithEmailAndPassword","value","credential","addId","catch","error","code","set","merge","exists","student","location","href","teacher","boss","persistence","setPersistence","Auth","Persistence","LOCAL","emailValue","trim","edDocValue","passValue","confirmPassValue","inputsBoxes","querySelectorAll","inputBox","input","setErrorFor","setSuccessFor","message","parentElement","small","innerText","classList","add","remove"],"mappings":"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","file":"signUp.9b033276.js","sourceRoot":"..\\src","sourcesContent":["var firebaseConfig = {\r\n    apiKey: \"AIzaSyDjl6bYnNz0DdeWM7hWxITVpn1BQq6SSjI\",\r\n    authDomain: \"pdg-db.firebaseapp.com\",\r\n    projectId: \"pdg-db\",\r\n    storageBucket: \"pdg-db.appspot.com\",\r\n    messagingSenderId: \"848702577304\",\r\n    appId: \"1:848702577304:web:89c4212e674efb5c3bceed\",\r\n    measurementId: \"G-SBDH6RW0HW\"\r\n};\r\n\r\n// Initialize Firebase\r\nfirebase.initializeApp(firebaseConfig);\r\n\r\nwindow.addEventListener('load', ()=>{\r\n\r\n    const form = document.getElementById('sign-up');\r\n\r\n    const email = document.getElementById('email');\r\n    const idDoc = document.getElementById('idDoc');\r\n    const pass = document.getElementById('pass');\r\n    const confirmPass = document.getElementById('confirmPass');\r\n    const signUpBtn = document.querySelector('.login__button');\r\n\r\n    var auth = firebase.auth();\r\n    var db = firebase.firestore();\r\n\r\n    \r\n    auth.onAuthStateChanged(user =>{\r\n        //console.log(user.uid);\r\n        if(user){\r\n            console.log(\"user\", user.uid);\r\n            let actualUser = db.collection(\"people\").where(\"id\", \"==\", user.uid).get().then((querySnapshot) => {\r\n                querySnapshot.forEach((doc) => {\r\n                    console.log(doc.id, ' => ', doc.data());\r\n                    console.log('Este es su idDoc', doc.data().iddoc);\r\n                    goToRole(doc.data().iddoc);\r\n                });\r\n            });\r\n        }\r\n    });\r\n    \r\n    signUpBtn.addEventListener('click', ()=>{\r\n        if(validate()){\r\n            auth.createUserWithEmailAndPassword(email.value, pass.value)\r\n            .then(credential=>{\r\n                console.log(\"credential\", credential.user.uid);\r\n                addId(idDoc.value, credential.user.uid)\r\n                //goToRole(idDoc.value);\r\n            })\r\n            .catch(error=>{\r\n                console.log(error.code);\r\n            });\r\n        }\r\n    });\r\n\r\n    function addId(idDoc, id){\r\n        db.collection(\"people\").doc(idDoc).set({\r\n            id : id\r\n        }, { merge: true })\r\n        .then(() => {\r\n            console.log(\"Document successfully written!\");\r\n        })\r\n        .catch((error) => {\r\n            console.error(\"Error writing document: \", error);\r\n        });\r\n    }\r\n\r\n    function goToRole(idDoc){\r\n        db.collection(\"people\").doc(idDoc).get().then((doc) => {\r\n            if (doc.exists) {\r\n                if(doc.data().student){\r\n                    window.location.href = \"studentDash.html\"; \r\n                } else if(doc.data().teacher == true && doc.data().boss == false){\r\n                    window.location.href = \"teacherDash.html\";\r\n                } else if(doc.data().teacher && doc.data().boss){\r\n                    window.location.href = \"teacherBossDash.html\";\r\n                }\r\n            } else {\r\n                // doc.data() will be undefined in this case\r\n                console.log(\"No such document!\");\r\n            } \r\n        \r\n        });\r\n    }\r\n\r\n    function persistence(){\r\n        firebase.auth().setPersistence(firebase.auth.Auth.Persistence.LOCAL)\r\n        .then(() => {\r\n            //return firebase.auth().signInWithEmailAndPassword(email, pass);\r\n        })\r\n        .catch((error) => {\r\n            // Handle Errors here.\r\n            // var errorCode = error.code;\r\n            // var errorMessage = error.message;\r\n        });\r\n    }\r\n\r\n    function validate (){\r\n      /*  if(confirmPass.value != pass.value){\r\n            console.log(\"Contrase√±as no iguales :(\");\r\n            return false;\r\n            //poner para mostrar el error\r\n        }\r\n        //aqui validar correos\r\n        const re = /^(([^<>()[\\]\\\\.,;:\\s@\"]+(\\.[^<>()[\\]\\\\.,;:\\s@\"]+)*)|(\".+\"))@((\\[[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\.[0-9]{1,3}\\])|(([a-zA-Z\\-0-9]+\\.)+[a-zA-Z]{2,}))$/;\r\n        return re.test(String(email.value).toLowerCase());\r\n        //poner para mostrar el error*/\r\n\r\n        const emailValue = email.value.trim();\r\n        const edDocValue = idDoc.value.trim();\r\n        const passValue = pass.value.trim();\r\n        const confirmPassValue = confirmPass.value.trim();\r\n\r\n        const inputsBoxes = document.querySelectorAll('.login__inputBox');\r\n        inputsBoxes.forEach(inputBox =>{\r\n            const input = inputBox.querySelector('input');\r\n            if(input.value === \"\"){\r\n                setErrorFor(input, 'El campo es obligatorio');\r\n            } else{\r\n                setSuccessFor(input);\r\n            }\r\n        });\r\n\r\n        \r\n    };\r\n\r\n    function setErrorFor(input, message){\r\n        const inputBox = input.parentElement;\r\n        const small = inputBox.querySelector('small');\r\n        small.innerText = message;\r\n        inputBox.classList.add('login__inputError');\r\n    }\r\n\r\n    function setSuccessFor(input){\r\n        const inputBox = input.parentElement;\r\n        inputBox.classList.remove('login__inputError');\r\n    }\r\n\r\n});"]}